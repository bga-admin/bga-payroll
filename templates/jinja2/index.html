{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block extra_meta %}
<!-- Google Search Console verification -->
<meta name="google-site-verification" content="s2mSAaMuLO9-YuzuDOGBgHiGTSe9QN-mZ7XM8Vxxx90" />
{% endblock %}

{% block extra_css %}
<link href="{{ static('css/jquery-ui.min.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="row mb-5">
  <div class="col-md-10 offset-md-1 pl-0">
    <div class="alert alert-warning" role="alert">
      <p class="lead">
        <strong>Aliqua tempor officia tempor sed aute eu consectetur sunt sunt labore non.</strong>
      </p>

      <p>
        Consequat ut nostrud sunt et dolore in id sint exercitation amet enim dolor cupidatat et proident elit proident cupidatat aute ut ullamco adipisicing est sit sed eu aute non irure duis laboris qui deserunt proident aute sint.
      </p>

      <p class="text-center">
        <button class="btn btn-primary btn-lg">
          Donate to the BGA
        </button>
      </p>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-7 offset-md-1">
    <div class="row">
      <div class="jumbotron bg-light">
        <div class="row mb-lg-5">
          <div class="col-md-12">
            <h1 class="mb-5">Search Illinois public employee salary data</h1>
          </div>
          <div class="col-md-3 align-self-center d-none d-lg-block">
            <img src="{{ static('img/capitol-dome.png') }}" class="pr-2 img-fluid bga-blue-filter" />
          </div>
          <div class="col-md align-self-center">
              <p class="lead">Every year, the Better Government Association compiles <strong class="bg-warning">Illinois’ most comprehensive database</strong> to review, explore and compare compensation for public employees throughout Illinois. We do this because the BGA believes detailing how tax dollars are spent serves the public interest.</p>
          </div>
        </div>

        <form id="entity-form">
          <div class="row">
            <div class="col-md mb-3">
              <strong class="mr-3">I'm looking for a:</strong>
              <div class="form-check form-check-inline">
                <input class="form-check-input entity-type-check" type="checkbox" id="unit-check" value="unit" checked>
                <label class="form-check-label" for="unit-check"><i class="fas fa-building"></i> Unit</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input entity-type-check" type="checkbox" id="department-check" value="department" checked>
                <label class="form-check-label" for="department-check"><i class="far fa-building"></i> Department</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input entity-type-check" type="checkbox" id="person-check" value="person" checked>
                <label class="form-check-label" for="person-check"><i class="far fa-address-card"></i> Person</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md">
              <div class="input-group">
                <input type="text" id="entity-lookup" class="form-control form-control-lg" autofocus />
                <div class="input-group-append">
                  <button type="submit" class="btn btn-primary btn-lg" id="submit-button" disabled>
                    <i class="fas fa-search"></i> Search
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md mt-3 text-smaller">
              <strong class="pr-2">For example,</strong>
              <a href="/search/?name=Cook County&entity_type=unit" class="pr-2"><i class="fa-fw fas fa-building"></i> Cook County</a>
              <a href="/search/?name=Chicago Police Department&entity_type=department" class="pr-2"><i class="fa-fw far fa-building"></i> Chicago Police Department</a>
              <a href="/search/?name=Rahm Emanuel&entity_type=person" class="pr-2"><i class="fa-fw far fa-address-card"></i> Rahm Emanuel</a>
            </div>
          </div>
        </form>
      </div><!-- .jumbotron -->
    </div>

    <div class="row mt-4">
      <div class="col-md">
        <div class="clearfix mb-3">
          <div class="row h-100">
            <div class="col-9 my-auto">
              <h3>What's inside?</h3>
            </div>
            <div class="col-3 my-auto">
              {% include 'partials/year_selector.html' %}
            </div>
          </div>
        </div>

        <div class="alert alert-secondary my-4" role="alert">
          <i class="fas fa-info-circle fa-fw"></i> <strong>Use the "Data Year" dropdown menu</strong> to view data from other years.
        </div>

        <p>The <strong>Illinois Public Salaries Database</strong> contains the base and additional pay (such as overtime) for <strong id="index-salary-count"></strong> state, municipal, school and many other government employees across Illinois. It covers <strong id="index-unit-count"></strong> units of government. We’ve recently updated the database so users find it easier to navigate. <a href="{{ url('user_guide') }}">You can learn how to use this new database here</a>.</p>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md">
        <h5>Distribution of public salaries in <span id="index-year"></span></h5>
      </div>
    </div>

    <div class="row">
      <div class="col-md">
        <div id="employee-distribution-chart"></div>
      </div>
    </div>

    <div class="mt-4"></div>
  </div>

  <div class="col-md-3">
    {% include 'partials/donate.html' %}
    {% include 'partials/story_feed.html' %}
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script type="text/javascript" src="{{ static('js/lib/jquery-ui.min.js') }}"></script>
<script src="{{ static('js/search.js') }}"></script>
<script type="text/javascript" src="{{ static('js/entity_auto_complete.js') }}"></script>

{% compress js %}
<script type="module">
  import { ChartHelper } from  "js/chart_helper"
  import { initDataYearToggle } from  "js/data_year_toggle"

  // Style the charts a little differently on the homepage.
  Highcharts.setOptions({
    chart: {
      backgroundColor: '#f7f7f7',
    },
    plotOptions: {
      series: {
        borderColor: '#f7f7f7',
      }
    }
  });

  initSearch({{ request.GET.dict()|safe }});

  const dataYear = $('#selected-year').text();

  function updateChart (year, result) {
    ChartHelper.make_salary_chart(result.salary_json, 'employee');
    $('#index-salary-count').text(result.salary_count);
    $('#index-unit-count').text(result.unit_count);
    $('#index-year').text(year);
  }

  initDataYearToggle('index', null, dataYear, updateChart);
</script>
{% endcompress %}
{% endblock %}
